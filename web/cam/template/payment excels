table id,payment type,sheet number,sheet name,sql

1,Dist PrePaid ARPU Payment Type,1,sheet one,SELECT 
    xt1.DCM_NAME AS "DCM Name",
    xt1.total_item_amount AS "Total lines ",
    xt1.xCommission_Total as "Commission Total Amount" ,
    abs (nvl(xt4.unreal_deduction, '0')) AS "UnReal Deduction",
    (  xt1.xCommission_Total - abs(nvl(xt4.unreal_deduction, 0))) as "Net Amount" ,
    abs (nvl(xt3.sd_deduction,0)) as "SD Deduction",
    abs (nvl(xt2.xCommission_Deduction,0)) as "Deduction", 
    (xt1.xCommission_Total - abs(nvl(xt4.unreal_deduction, 0)) - abs(nvl(xt3.sd_deduction,0))- nvl(xt2.xCommission_Deduction,0)) as  "Net Commission"
FROM        
        (SELECT tt8.DCM_ID, tt8.DCM_NAME  , tt8.DCM_CODE  DCM_CODE, 
        SUM(tt6.COMMISSION_ITEM_AMOUNT * tt7.COMMISSION_FACTOR_VALUE)  xCommission_Total, 
        sum (tt6.COMMISSION_ITEM_AMOUNT ) total_item_amount
        FROM 
            PAYMENT_DETAIL tt1
            JOIN PAYMENT_COMMISSION tt4 ON (tt4.PAYMENT_DETAIL_ID = tt1.PAYMENT_DETAIL_ID )
            JOIN COMMISSION_DETAIL tt5 ON (tt5.COMMISSION_DETAIL_ID = tt4.COMMISSION_DETAIL_ID)
            JOIN COMMISSION_ITEM tt6 ON (tt6.COMMISSION_DETAIL_ID = tt5.COMMISSION_DETAIL_ID )
            JOIN COMMISSION_FACTOR tt7 ON (tt6.COMMISSION_FACTOR_ID = tt7.COMMISSION_FACTOR_ID )
            JOIN GEN_DCM tt8 ON (tt6.DCM_ID = tt8.DCM_ID)
            JOIN COMMISSION_TYPE_CATEGORY tt9 ON (tt5.COMMISSION_TYPE_CATEGORY_ID = tt9.COMMISSION_TYPE_CATEGORY_ID)
            JOIN COMMISSION_TYPE tt10 ON (tt9.COMMISSION_TYPE_ID = tt10.COMMISSION_TYPE_ID)
        WHERE tt10.COMMISSION_TYPE_ID = 1 AND tt1.PAYMENT_DETAIL_ID= ? 
        GROUP BY tt8.DCM_ID, tt8.DCM_CODE, tt8.DCM_NAME ) xt1 
    LEFT JOIN
    (SELECT tt6.DCM_ID, SUM(tt6.COMMISSION_ITEM_AMOUNT * tt7.COMMISSION_FACTOR_VALUE) AS sd_deduction
        FROM
          PAYMENT_DETAIL tt1
            JOIN PAYMENT_COMMISSION tt4 ON (tt4.PAYMENT_DETAIL_ID = tt1.PAYMENT_DETAIL_ID )
            JOIN COMMISSION_DETAIL tt5 ON (tt5.COMMISSION_DETAIL_ID = tt4.COMMISSION_DETAIL_ID)
            JOIN COMMISSION_ITEM tt6 ON (tt6.COMMISSION_DETAIL_ID = tt5.COMMISSION_DETAIL_ID )
            JOIN COMMISSION_FACTOR tt7 ON (tt6.COMMISSION_FACTOR_ID = tt7.COMMISSION_FACTOR_ID )
            JOIN GEN_DCM tt8 ON (tt6.DCM_ID = tt8.DCM_ID)
            JOIN COMMISSION_TYPE_CATEGORY tt9 ON (tt5.COMMISSION_TYPE_CATEGORY_ID = tt9.COMMISSION_TYPE_CATEGORY_ID)
            JOIN COMMISSION_TYPE tt10 ON (tt9.COMMISSION_TYPE_ID = tt10.COMMISSION_TYPE_ID)
           WHERE tt10.COMMISSION_TYPE_ID=2 AND tt1.PAYMENT_DETAIL_ID= ?
        GROUP BY tt6.DCM_ID) xt3 on xt1.DCM_ID = xt3.DCM_ID
    LEFT JOIN
    (SELECT  tt6.DCM_ID, SUM(tt6.COMMISSION_ITEM_AMOUNT * tt7.COMMISSION_FACTOR_VALUE) AS unreal_deduction
        FROM
            PAYMENT_DETAIL tt1
            JOIN PAYMENT_COMMISSION tt4 ON (tt4.PAYMENT_DETAIL_ID = tt1.PAYMENT_DETAIL_ID )
            JOIN COMMISSION_DETAIL tt5 ON (tt5.COMMISSION_DETAIL_ID = tt4.COMMISSION_DETAIL_ID)
            JOIN COMMISSION_ITEM tt6 ON (tt6.COMMISSION_DETAIL_ID = tt5.COMMISSION_DETAIL_ID )
            JOIN COMMISSION_FACTOR tt7 ON (tt6.COMMISSION_FACTOR_ID = tt7.COMMISSION_FACTOR_ID )
            JOIN GEN_DCM tt8 ON (tt6.DCM_ID = tt8.DCM_ID)
            JOIN COMMISSION_TYPE_CATEGORY tt9 ON (tt5.COMMISSION_TYPE_CATEGORY_ID = tt9.COMMISSION_TYPE_CATEGORY_ID)
            JOIN COMMISSION_TYPE tt10 ON (tt9.COMMISSION_TYPE_ID = tt10.COMMISSION_TYPE_ID)
           WHERE tt9.COMMISSION_TYPE_CATEGORY_NAME='DIST_Line_Unreal_Deduction' AND tt1.PAYMENT_DETAIL_ID= ?
        GROUP BY tt6.DCM_ID ) xt4 on xt1.DCM_ID = xt4.DCM_ID
    LEFT JOIN
    (SELECT DCM_ID, SUM(DEDUCTION_VALUE )  xCommission_Deduction FROM CAM_DEDUCTION tt7 group by tt7.DCM_ID)  xt2 on xt1.DCM_ID = xt2.DCM_ID

13,D2D Line Payment Type,1,samuel,select * from gen_dcm

14,D2D Line Payment Type,2,two,mklfmslkdfmklsmdf

15,Dist PrePaid ARPU Payment Type,2,sheet two,SELECT 
    xt1.DCM_CODE,
    xt1.DCM_NAME AS "DCM Name",
    xt1.COMMISSION_ITEM_NAME AS "ITEM NAME",
    xt1.COMMISSION_ITEM_AMOUNT AS "ITEM_COUNT",
    xt1.COMMISSION_FACTOR_VALUE AS "FACTOR VALUE",  
    xt1.xcommission_value AS "COMMISSION_VALUE" 
   
FROM        
        (SELECT tt8.DCM_ID, tt8.DCM_NAME  , tt8.DCM_CODE  DCM_CODE , tt6.COMMISSION_ITEM_NAME, tt6.COMMISSION_ITEM_AMOUNT, tt7.COMMISSION_FACTOR_VALUE,(tt6.COMMISSION_ITEM_AMOUNT * tt7.COMMISSION_FACTOR_VALUE) xcommission_value 
        
       
        FROM 
        
            PAYMENT_DETAIL tt1
            JOIN PAYMENT_COMMISSION tt4 ON (tt4.PAYMENT_DETAIL_ID = tt1.PAYMENT_DETAIL_ID ) 
            JOIN COMMISSION_DETAIL tt5 ON (tt5.COMMISSION_DETAIL_ID = tt4.COMMISSION_DETAIL_ID)
            JOIN COMMISSION_ITEM tt6 ON (tt6.COMMISSION_DETAIL_ID = tt5.COMMISSION_DETAIL_ID )
            JOIN COMMISSION_FACTOR tt7 ON (tt6.COMMISSION_FACTOR_ID = tt7.COMMISSION_FACTOR_ID )
            JOIN GEN_DCM tt8 ON (tt6.DCM_ID = tt8.DCM_ID)
            JOIN COMMISSION_TYPE_CATEGORY tt9 ON (tt5.COMMISSION_TYPE_CATEGORY_ID = tt9.COMMISSION_TYPE_CATEGORY_ID)
            JOIN COMMISSION_TYPE tt10 ON (tt9.COMMISSION_TYPE_ID = tt10.COMMISSION_TYPE_ID)                      
            
        WHERE  tt1.PAYMENT_DETAIL_ID = ? and tt7.COMMISSION_FACTOR_VALUE != 0         
         
         ) xt1

17,Khadamaty Line Payment Type,1,dasdasd,sasasasasas

18,D2D ARPU  Payment Type,1,sasdas,insert into CAM_PAYMENT_EXCEL_MANAGEMENT(PAYMENT_EXCEL_MENEGEMENT_ID,PAYMENT_TYPE_ID,EXCEL_SHEET_NUMBER,EXCEL_SHEET_NAME,EXCEL_SHEET_SQL_STATEMENT)
   values(PAYMENT_EXCEL_MANAGEMENT_SEQ.nextval,paymentTypeId, sheetNumber ,sheetName ,sqlStatement);

20,D2D ARPU  Payment Type,2,asdasdf,insert into CAM_PAYMENT_EXCEL_MANAGEMENT(PAYMENT_EXCEL_MENEGEMENT_ID,PAYMENT_TYPE_ID,EXCEL_SHEET_NUMBER,EXCEL_SHEET_NAME,EXCEL_SHEET_SQL_STATEMENT)
   values(PAYMENT_EXCEL_MANAGEMENT_SEQ.nextval,paymentTypeId, sheetNumber ,sheetName ,sqlStatement);

21,Add & Win Line First Layer Payment Type,12323232,temp test,update CAM_SQL_TEMPLATES set TEMPLATE_SQL=? 

